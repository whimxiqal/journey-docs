"use strict";(self.webpackChunkjourney_docs=self.webpackChunkjourney_docs||[]).push([[307],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>h});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=o.createContext({}),u=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=u(e.components);return o.createElement(s.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(t),m=a,h=c["".concat(s,".").concat(m)]||c[m]||d[m]||r;return t?o.createElement(h,i(i({ref:n},p),{},{components:t})):o.createElement(h,i({ref:n},p))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var u=2;u<r;u++)i[u]=t[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},5162:(e,n,t)=>{t.d(n,{Z:()=>i});var o=t(7294),a=t(6010);const r="tabItem_Ymn6";function i(e){let{children:n,hidden:t,className:i}=e;return o.createElement("div",{role:"tabpanel",className:(0,a.Z)(r,i),hidden:t},n)}},4866:(e,n,t)=>{t.d(n,{Z:()=>N});var o=t(7462),a=t(7294),r=t(6010),i=t(2466),l=t(6550),s=t(1980),u=t(7392),p=t(12);function c(e){return function(e){return a.Children.map(e,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:n,label:t,attributes:o,default:a}}=e;return{value:n,label:t,attributes:o,default:a}}))}function d(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??c(t);return function(e){const n=(0,u.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:t}=e;const o=(0,l.k6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,s._X)(r),(0,a.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(o.location.search);n.set(r,e),o.replace({...o.location,search:n.toString()})}),[r,o])]}function y(e){const{defaultValue:n,queryString:t=!1,groupId:o}=e,r=d(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const o=t.find((e=>e.default))??t[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:n,tabValues:r}))),[s,u]=h({queryString:t,groupId:o}),[c,y]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[o,r]=(0,p.Nk)(t);return[o,(0,a.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:o}),b=(()=>{const e=s??c;return m({value:e,tabValues:r})?e:null})();(0,a.useEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),y(e)}),[u,y,r]),tabValues:r}}var b=t(2389);const f="tabList__CuJ",k="tabItem_LNqP";function g(e){let{className:n,block:t,selectedValue:l,selectValue:s,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const n=e.currentTarget,t=p.indexOf(n),o=u[t].value;o!==l&&(c(n),s(o))},m=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=p.indexOf(e.currentTarget)+1;n=p[t]??p[0];break}case"ArrowLeft":{const t=p.indexOf(e.currentTarget)-1;n=p[t]??p[p.length-1];break}}n?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n)},u.map((e=>{let{value:n,label:t,attributes:i}=e;return a.createElement("li",(0,o.Z)({role:"tab",tabIndex:l===n?0:-1,"aria-selected":l===n,key:n,ref:e=>p.push(e),onKeyDown:m,onClick:d},i,{className:(0,r.Z)("tabs__item",k,i?.className,{"tabs__item--active":l===n})}),t??n)})))}function v(e){let{lazy:n,children:t,selectedValue:o}=e;if(n){const e=t.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},t.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==o}))))}function w(e){const n=y(e);return a.createElement("div",{className:(0,r.Z)("tabs-container",f)},a.createElement(g,(0,o.Z)({},e,n)),a.createElement(v,(0,o.Z)({},e,n)))}function N(e){const n=(0,b.Z)();return a.createElement(w,(0,o.Z)({key:String(n)},e))}},1464:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var o=t(7462),a=(t(7294),t(3905));t(4866),t(5162);const r={sidebar_label:"Scopes",sidebar_position:4,description:"Adding custom destinations"},i="Scopes",l={unversionedId:"dev/scopes",id:"dev/scopes",title:"Scopes",description:"Adding custom destinations",source:"@site/docs/dev/scopes.md",sourceDirName:"dev",slug:"/dev/scopes",permalink:"/docs/dev/scopes",draft:!1,editUrl:"https://github.com/journey-docs/docs/dev/scopes.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_label:"Scopes",sidebar_position:4,description:"Adding custom destinations"},sidebar:"tutorialSidebar",previous:{title:"Running Searches",permalink:"/docs/dev/run-searches"},next:{title:"Tunnels",permalink:"/docs/dev/tunnels"}},s={},u=[{value:"Structure",id:"structure",level:2},{value:"<code>VirtualMap</code>",id:"virtualmap",level:2},{value:"&quot;Strict&quot;",id:"strict",level:2},{value:"Complete Example",id:"complete-example",level:2}],p={toc:u};function c(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"scopes"},"Scopes"),(0,a.kt)("p",null,"A ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," contains information about points of interest around your Minecraft server. Each one of these places, called a ",(0,a.kt)("inlineCode",{parentName:"p"},"Destination"),", is usually context-specific and has other information associated with it. So, in a ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),", you can encode the context, name, description, and permission for any number of ",(0,a.kt)("inlineCode",{parentName:"p"},"Destination"),"s."),(0,a.kt)("h2",{id:"structure"},"Structure"),(0,a.kt)("p",null,"A ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," will also often have some number of ",(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scope"),"s, which allow you to define all of your ",(0,a.kt)("inlineCode",{parentName:"p"},"Destinations")," in a tree-like pattern. For example, in ",(0,a.kt)("a",{parentName:"p",href:"/docs/admin/integration"},"JourneyIntegrator"),", there is an ",(0,a.kt)("a",{parentName:"p",href:"https://essentialsx.net/"},"Essentials")," ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," that has ",(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scope"),'s for "warps" and also for players\' "homes". Each of those ',(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scopes")," contain 0 ",(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scopes")," and contain a bunch of ",(0,a.kt)("inlineCode",{parentName:"p"},"Destinations"),"."),(0,a.kt)("p",null,"Journey lets you register you own ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),", which gets placed just under the Journey-wide ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),' "root" as a ',(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scope"),". No two ",(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scope"),"s or ",(0,a.kt)("inlineCode",{parentName:"p"},"Destinations")," may have the same ID within a ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),"."),(0,a.kt)("p",null,"You can build your own ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," by either inheriting the ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," interface. Or, you can build an inline ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," using the ",(0,a.kt)("inlineCode",{parentName:"p"},"ScopeBuilder"),"."),(0,a.kt)("p",null,"Let's say you are developing a town plugin. There will be multiple towns, and each town has multiple buildings. People may only journey to buildings inside towns to which they have permission."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'Scope myScope = Scope.builder()\n    .name(Component.text("Towns").color(NamedTextColor.BLUE))\n    .description(Component.text("Journey to towns in My Plugin").color(NamedTextColor.GREEN))\n    .subScopes(/* ... add scopes for each town here ... */)\n    .build();\n')),(0,a.kt)("p",null,"Register your ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," to Journey using the ",(0,a.kt)("inlineCode",{parentName:"p"},"JourneyApiProvider"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"JourneyApi journey = JourneyApiProvider.get();\n\njourney.registerScope(myScope);\n")),(0,a.kt)("h2",{id:"virtualmap"},(0,a.kt)("inlineCode",{parentName:"h2"},"VirtualMap")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scopes")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"Destinations")," must be added in a ",(0,a.kt)("inlineCode",{parentName:"p"},"VirtualMap"),", which supplies a ",(0,a.kt)("inlineCode",{parentName:"p"},"Map")," given a ",(0,a.kt)("a",{parentName:"p",href:"/docs/dev/journey-agent"},(0,a.kt)("inlineCode",{parentName:"a"},"JourneyPlayer")),". The internal map is keyed by the value's identifier, and the value is either a ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," or a ",(0,a.kt)("inlineCode",{parentName:"p"},"Destination"),". "),(0,a.kt)("p",null,"The motivation for a wrapper around the map is that there may be some cases where the number of items in the map is very large and would require a good deal of time and memory to load. If this is a concern, then you may manually set the ",(0,a.kt)("inlineCode",{parentName:"p"},"size()")," of a ",(0,a.kt)("inlineCode",{parentName:"p"},"VirtualMap")," and leave the actual data in a ",(0,a.kt)("inlineCode",{parentName:"p"},"Supplier<Map<>>")," to only be loaded if the ",(0,a.kt)("inlineCode",{parentName:"p"},"size()")," is small enough to warrant it. In this way, the items in the map will be provided if requested by the user, but the full map will only be loaded and presented to the user in situations where the total set of options should be limited, like for command completion."),(0,a.kt)("h2",{id:"strict"},'"Strict"'),(0,a.kt)("p",null,'A "strict" ',(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," is one in which the internal components must be contextualized with the ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," itself and the values within may never be specified when taken out of that context. Many of your ",(0,a.kt)("inlineCode",{parentName:"p"},"Scopes"),' probably should be "strict" to avoid confusion with conflicting names of ',(0,a.kt)("inlineCode",{parentName:"p"},"Destinations")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"sub-Scopes")," that are way down the ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," tree. Otherwise, if a ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),' is not "strict", then the name of its components may be named in some situations without needing the parent ',(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),"'s name, as long as there aren't any name conflicts. In the case of the town plugin, you may want the town scope to be \"strict\" so that you need to contextualize the building names, but you may not want the overall ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," to be strict so that you may name each of the towns without needing to specify your plugin as the overall context."),(0,a.kt)("p",null,"A single ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," for a town using Bukkit may look like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'Town myTown = /* ... your town object ... */\n\nJourneyBukkitApi journeyBukkit = JourneyBukkitApiProvider.get();\n\nScope myTownScope = Scope.builder()\n    .name(Component.text(myTown.name()))\n    /* you don\'t need a description */\n    .destinations(VirtualMap.of(() -> myTown.buildings()\n        .stream()\n        .collect(Collectors.toMap(building -> building.id(), \n          building -> Destination.of(journeyBukkit.toCell(building.location()))))))\n    .permission("myplugin.town." + myTown.id())  // only let people with town permissions use this scope\n    .strict()  // the buildings must be contextualized under this town if anyone wants to use it\n    .build()\n')),(0,a.kt)("p",null,"You can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"DestinationBuilder")," to add a name, description, and permission to your destinations, just like with a ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope"),"."),(0,a.kt)("h2",{id:"complete-example"},"Complete Example"),(0,a.kt)("p",null,"Finally, your whole registration for a Bukkit plugin may look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'\nint numberOfTowns() {\n  /* returns number of towns quickly */\n}\n\nCollection<Town> towns() {\n  /* returns all towns in your plugin */\n}\n\n@Override\nvoid onEnable() {\n\n  // ...\n\n  JourneyBukkitApi journeyBukkit = JourneyBukkitApiProvider.get();\n\n  Scope myScope = Scope.builder()\n    .name(Component.text("Towns").color(NamedTextColor.BLUE))\n    .description(Component.text("Journey to towns in My Plugin").color(NamedTextColor.GREEN))\n    .subScopes(VirtualMap.of(() -> towns().stream()\n      .collect(Collectors.toMap(town -> town.id(), town -> Scope.builder()\n        .name(Component.text(myTown.name()))\n        .destinations(VirtualMap.of(myTown.buildings()\n            .stream()\n            .collect(Collectors.toMap(building -> building.id(), building -> \n              Destination.builder(journeyBukkit.toCell(building.location())\n                .name(Component.text(building.name()))\n                .build())))))\n        .permission("myplugin.town." + myTown.id())\n        .strict()\n        .build()))\n      .build(), numberOfTowns()))\n    .build();\n\n  JourneyApi journey = JourneyApiProvider.get();\n\n  journey.registerScope(myScope);\n\n  // ...\n  \n}\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"If your ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," gets too complex, consider implementing the ",(0,a.kt)("inlineCode",{parentName:"p"},"Scope")," class directly for better organization.")))}c.isMDXComponent=!0}}]);